# 09_이진 분류(Binary Classification) 정리

## 이진 분류 모델 개요

- **이진 분류(Binary Classification)**란 입력 데이터를 두 가지 범주(예: 0/1, 참/거짓 등) 중 하나로 분류하는 문제를 다룹니다.


## 1. 트레이닝 데이터 사용

- **특징 변수(Feature)와 목표 변수(Target) 사이의 관계**를 학습합니다.
- 목표 변수는 두 가지 클래스(0, 1)로 변환하여 사용합니다.


## 2. 새로운 데이터 분류

- 트레이닝 데이터에 포함되지 않은 **새로운 데이터를 두 범주 중 하나로 분류**하는 모델을 만듭니다.


## 3. 목표 변수 변환

- **목표 변수(정답 레이블)를 이산형(0, 1) 값**으로 변환하여 학습에 사용합니다.


## 데이터 분할

| 구분 | 설명 |
| :-- | :-- |
| 트레이닝 데이터 | 모델의 가중치와 바이어스를 학습시키는 데 사용 |
| 검증 데이터 | 학습 중간에 모델의 성능을 평가하고 과적합을 방지하는 데 사용 |
| 테스트 데이터 | 학습이 끝난 후, 모델의 실제 성능을 최종 평가하는 데 사용 |

- **random_state=42**:
데이터를 무작위로 섞을 때, **항상 동일한 결과가 나오도록 시드를 고정**하는 역할을 합니다.


## 배치(Batch)

- **정의**: 데이터를 여러 개 묶어서 한 번에 처리하는 단위
- **배치 크기**: 16, 32, 64 등으로 설정하며,
미니 배치 경사하강법(Mini-batch Gradient Descent)에서 주로 사용
- **장점**: 계산 효율 증가, 메모리 사용량 조절, 학습 안정성 향상


## 경사하강법(Gradient Descent) 종류 및 특징

- **경사하강법**: 전체 데이터로 한 번에 기울기를 계산해 가중치 업데이트
    - 속도 느림, 안정적
- **확률적 경사하강법(SGD)**: 데이터 한 개씩 업데이트
    - 노이즈 많고, 학습이 불안정할 수 있음
- **미니 배치 경사하강법**: 데이터 일부(배치 단위)로 업데이트
    - 속도 빠르고, 안정성과 효율성 모두 확보


## 이진 분류 모델의 로지스틱 회귀(Logistic Regression)

### 로지스틱 회귀란?

- **트레이닝 데이터의 특성과 분포**를 바탕으로 데이터를 잘 구분할 수 있는 **최적의 결정 경계**를 찾습니다.
- **시그모이드 함수(sigmoid function)**를 사용하여 예측값을 0~1 사이의 확률로 변환합니다.
    - 시그모이드 함수:
\$ \sigma(z) = \frac{1}{1 + e^{-z}} \$
    - 입력값이 0에 가까우면 0.5, 크면 1, 작으면 0에 가까운 값이 나옴


### PyTorch 코드 예시

```python
import torch.nn as nn

class LogisticRegressionModel(nn.Module):
    def __init__(self):
        super(LogisticRegressionModel, self).__init__()
        self.linear = nn.Linear(1, 1)      # 입력 1, 출력 1
        self.sigmoid = nn.Sigmoid()        # 시그모이드 함수

    def forward(self, x):
        z = self.linear(x)                 # 선형 변환
        y = self.sigmoid(z)                # 확률로 변환
        return y
```

- **self.linear**: 입력과 출력이 1개인 선형 계층
- **self.sigmoid**: 선형 계층의 출력을 0~1 사이 확률로 변환


### 순전파(Forward) 과정

1. 입력값 x를 **선형 계층**에 통과시켜 z 계산
2. z를 **시그모이드 함수**에 넣어 y(확률) 계산
3. y가 0.5 이상이면 1(Positive), 미만이면 0(Negative)로 분류

## 정리

- 이진 분류는 **두 가지 범주로 데이터를 분류**하는 문제
- **데이터 분할**: 트레이닝, 검증, 테스트 데이터로 나누어 사용
- **배치**: 데이터를 묶어서 처리해 효율적 학습 가능
- **경사하강법**: 미니 배치 방식이 실무에서 가장 많이 쓰임
- **로지스틱 회귀**: 시그모이드 함수를 사용해 확률적 이진 분류를 수행함
